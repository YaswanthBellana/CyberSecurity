Option Explicit

' Define the phone number and message
Dim phoneNumber, message, url, shell, currentTime, timeHour, timeMinute

' Initialize variables
phoneNumber = "" ' write the mobile number
message = "hi, Good morning"

' Get the current time
currentTime = Now
timeHour = Hour(currentTime)
timeMinute = Minute(currentTime) + 1

' Adjust for overflow in minutes
If timeMinute >= 60 Then
    timeMinute = timeMinute - 60
    timeHour = timeHour + 1
End If

' Encode the message for the URL
message = Replace(message, " ", "%20") ' URL encode spaces
url = "https://web.whatsapp.com/send?phone=" & phoneNumber & "&text=" & message

' Launch the default browser with the WhatsApp Web URL
Set shell = CreateObject("WScript.Shell")
shell.Run url, 1, False

' Wait for the page to load
WScript.Sleep 10000 ' Wait 10 seconds for WhatsApp Web to load completely

' Simulate pressing the Enter key to send the message
shell.SendKeys "{ENTER}"

' Wait for a short while before typing the message again
WScript.Sleep 5000 ' Wait 5 seconds before typing the message multiple times

' Type the message multiple times
Dim i
For i = 1 To 5
    shell.SendKeys message
    shell.SendKeys "{ENTER}"
    WScript.Sleep 1000 ' Wait 1 second between messages
Next

' Notify the user
MsgBox "Messages sent! Check WhatsApp Web for confirmation.", vbInformation, "WhatsApp Web Automation"

' Cleanup
Set shell = Nothing